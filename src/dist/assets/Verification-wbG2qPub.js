import{k as i,a0 as S,j as e,aS as w,ae as E,G as s,C as k,B as b,S as p,d as n,a4 as T,t as u,D as R,ad as f}from"./index-jfPFzjbI.js";import{L as I}from"./Link-n2lUMppv.js";const P=()=>{const[c,g]=i.useState(Array(6).fill("")),[x,d]=i.useState(""),[l,m]=i.useState(10),j=S(),h=i.useRef([]);i.useEffect(()=>{if(l>0){const a=setInterval(()=>{m(t=>t>0?t-1:0)},1e3);return()=>clearInterval(a)}},[l]);const y=async()=>{try{const a=localStorage.getItem("email"),t=localStorage.getItem("accessToken"),r=c.join("");if(!a||!t)throw new Error("Email or accessToken not found in localStorage");const o=await f.post("http://localhost:8080/api/verify",{email:a,otp:r},{headers:{Authorization:`Bearer ${t}`}});if(console.log("Response Status:",o.status),console.log("Response Data:",o.data),o.status===200)console.log("Email verified successfully"),j("/dashboard/default/");else throw new Error("Failed to verify email")}catch(a){console.error("Error verifying email:",a),d("Failed to verify email. Please try again.")}},v=async()=>{var a,t;try{const r=localStorage.getItem("email");if(!r||!/^\S+@\S+\.\S+$/.test(r))throw new Error("Invalid or missing email in localStorage");const o=await f.post("http://localhost:8080/api/auth/resend-otp",{email:r});console.log("OTP resent successfully:",o.data),m(10),d("")}catch(r){const o=((t=(a=r.response)==null?void 0:a.data)==null?void 0:t.errorMessage)||"Failed to resend OTP. Please try again.";console.error("Error resending OTP:",o),d(o)}},C=(a,t)=>{if(/^[0-9]$/.test(t)||t===""){const r=[...c];r[a]=t,g(r),t&&a<5&&h.current[a+1].focus()}};return e.jsxs(w,{maxWidth:"lg",sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","@media (max-width: 600px)":{justifyContent:"center"}},children:[e.jsx(I,{"aria-label":"theme logo",href:"/pages/code-verification/code-verification1",sx:{mb:4},children:e.jsx(E,{})}),e.jsx(s,{container:!0,spacing:2,justifyContent:"center",children:e.jsx(s,{item:!0,xs:12,md:6,lg:7,children:e.jsx(k,{elevation:3,sx:{p:4,boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"},children:e.jsx(b,{children:e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(s,{container:!0,direction:"row",alignItems:"center",justifyContent:"space-between",children:e.jsx(s,{item:!0,children:e.jsxs(p,{spacing:2,children:[e.jsx(n,{variant:"h2",gutterBottom:!0,children:"Email Verification Code"}),e.jsx(n,{variant:"h4",gutterBottom:!0,children:"Enter OTP"}),e.jsx(n,{variant:"caption",children:"Weâ€™ve sent you a code on jone.****@company.com"})]})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(s,{container:!0,spacing:1,children:c.map((a,t)=>e.jsx(s,{item:!0,xs:2,children:e.jsx(T,{"aria-label":`Character ${t+1}`,type:"text",autoComplete:"off",inputProps:{maxLength:1,style:{textAlign:"center"}},value:a,onChange:r=>C(t,r.target.value),onKeyDown:r=>{r.key==="Backspace"&&!c[t]&&t>0&&h.current[t-1].focus()},inputRef:r=>h.current[t]=r})},t))})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(u,{variant:"contained",color:"secondary",fullWidth:!0,size:"large",onClick:y,children:"Verify Email Address"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{direction:"row",justifyContent:"center",children:e.jsx(n,{variant:"h5",children:"Did not receive the email? Check your spam folder"})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(R,{})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(n,{variant:"h5",color:"secondary",textAlign:"center",children:["Code will be Resent in 00:",l.toString().padStart(2,"0"),"s"]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(u,{variant:"outlined",color:"secondary",fullWidth:!0,size:"large",onClick:v,disabled:l>0,children:"Resend Code"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(u,{variant:"text",color:"secondary",fullWidth:!0,size:"large",children:"Try Another Way"})}),x&&e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{variant:"body2",color:"error",children:x})})]})})})})})]})};export{P as default};
